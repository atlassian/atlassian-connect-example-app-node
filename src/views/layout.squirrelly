<!DOCTYPE html>
<html lang="en">
<head>
    <title>{{ it.title }} - Atlassian Connect Node Example App</title>
    <meta charset="UTF-8">
    <!-- AUI is being used for styling here [https://aui.atlassian.com/aui/latest/docs/getting-started.html]
        Please replace this if you want to add your own css frameworks -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/aui/9.5.1/aui/aui-prototyping.min.css" />
    <link rel="stylesheet" href="/public/css/main.css" media="all">

    <!-- This script is needed for all the views in the Connect app -->
    <script src="https://connect-cdn.atl-paas.net/all.js" data-options="sizeToParent:true" async></script>
</head>
<body>
    <div class="container">
        {{@includeFile('./partials/nav.squirrelly', it) /}}
        <div id="title">
            <h1>{{ it.title }}</h1>
            <button class="aui-button aui-button-subtle" onclick="window.open('https://github.com/atlassian/atlassian-connect-example-app-node/issues/new/choose')">
                <span class="aui-icon aui-icon-small aui-iconfont-feedback">Feedback</span>
                Give Feedback
            </button>
        </div>
        <section class="ac-content">
            {{* it.content }}
        </section>
        <div>
            <button id="setAppProperty">Set</button>
            <button id="getAppProperty">Get</button>
            <button id="removeAppProperty">Delete</button>
        </div>
        {{@includeFile('./partials/nav.squirrelly', it) /}}
    </div>
    <script>
        /**
         *  Page navigation is handled by AP.navigator
         *  source: https://developer.atlassian.com/cloud/jira/software/jsapi/navigator/
         */
        document.querySelectorAll('a')
            .forEach(el => {
				var attr = el.getAttribute('href');
				if(attr && attr.startsWith('~')) {
					el.addEventListener('click', (e) => {
						e.preventDefault();
						AP.navigator.go('addonmodule', { moduleKey: attr.slice(1) })
                    });
					el.href = "javascript:;";
                }
            });
    </script>
    <script src="/public/js/examples.js"></script>
    <script>
        document.querySelector('#setAppProperty').onclick = () => {
			AP.request({
				url: '/rest/atlassian-connect/latest/addons/com.example.node-connect-app/properties/isNotConfigured?jsonValue=true',
                type: 'PUT',
                data: `false`,
				success: function(response) {
					// Convert the string response to JSON
					response = JSON.parse(response);
					console.log("Successfully set", response);
				},
				error: function(response) {
					console.log(response);
				},
				contentType: "application/json",
                headers: {
					Accept: 'application/json',
                    'Content-Type': 'application/json'
                }
			});
        }

		document.querySelector('#getAppProperty').onclick = () => {
			AP.request({
				url: '/rest/atlassian-connect/latest/addons/com.example.node-connect-app/properties/isNotConfigured?jsonValue=true',
				success: function(response) {
					// Convert the string response to JSON
					response = JSON.parse(response);
					console.log("Successfully Get", response);
				},
				error: function(response) {
					console.log(response);
				},
				headers: {
					Accept: 'application/json',
					'Content-Type': 'application/json'
				},
				contentType: "application/json"
			});
		}

		document.querySelector('#removeAppProperty').onclick = () => {
			AP.request({
				url: '/rest/atlassian-connect/latest/addons/com.example.node-connect-app/properties/isNotConfigured?jsonValue=true',
                type: 'DELETE',
				success: function(response) {
					// Convert the string response to JSON
					response = JSON.parse(response);
					console.log("Successfully Delete", response);
				},
				error: function(response) {
					console.log(response);
				},
				headers: {
					Accept: 'application/json',
					'Content-Type': 'application/json'
				},
				contentType: "application/json"
			});
		}
    </script>
</body>
</html>
